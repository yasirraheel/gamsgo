<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings - DigiMarket Admin</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
      tailwind.config = {
        darkMode: 'class',
        theme: {
          extend: {
            fontFamily: { sans: ['Inter', 'sans-serif'] },
            colors: {
              primary: '#6366f1',
              primaryDark: '#4f46e5',
              secondary: '#ec4899',
              dark: '#0f172a',
              darker: '#020617',
              card: '#1e293b',
            }
          }
        }
      }
    </script>
    <style>
      body { background-color: #020617; color: #f8fafc; }
      .glass-panel { background: rgba(30, 41, 59, 0.7); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.08); }
      .gradient-text { background: linear-gradient(135deg, #818cf8 0%, #c084fc 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
      ::-webkit-scrollbar { width: 8px; }
      ::-webkit-scrollbar-track { background: #0f172a; }
      ::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }
      ::-webkit-scrollbar-thumb:hover { background: #475569; }
    </style>
</head>
<body class="min-h-screen">
    <nav class="fixed top-0 w-full z-40 glass-panel border-b border-gray-800">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
            <div class="flex items-center gap-2">
                <div class="w-8 h-8 rounded bg-gradient-to-tr from-red-500 to-orange-500 flex items-center justify-center text-white font-bold">
                    <i class="fa-solid fa-cog text-xs"></i>
                </div>
                <span class="font-bold text-xl tracking-tight text-white">Admin <span class="text-red-500">Settings</span></span>
            </div>
            <a href="index.php" class="px-4 py-2 rounded-lg text-sm bg-gray-800 border border-gray-700 text-gray-200 hover:bg-gray-700 transition-colors">
                <i class="fa-solid fa-arrow-left mr-2"></i>Back to Store
            </a>
        </div>
    </nav>

    <main class="pt-24 pb-20 px-4 max-w-5xl mx-auto">
        <div id="toast-container" class="fixed bottom-4 right-4 z-50 flex flex-col gap-2"></div>
        
        <div class="mb-8">
            <h1 class="text-3xl font-bold text-white mb-2">Site Settings</h1>
            <p class="text-gray-400">Configure your marketplace settings and integrations</p>
        </div>

        <form id="settings-form" class="space-y-6">
            <!-- General Settings -->
            <div class="glass-panel rounded-2xl p-6">
                <h2 class="text-xl font-bold text-white mb-4 flex items-center gap-2">
                    <i class="fa-solid fa-globe text-primary"></i> General Information
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-xs font-medium text-gray-400 mb-1">Site Name</label>
                        <input type="text" name="site_name" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-primary" placeholder="DigiMarket">
                    </div>
                    <div>
                        <label class="block text-xs font-medium text-gray-400 mb-1">Support Email</label>
                        <input type="email" name="support_email" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-primary" placeholder="support@example.com">
                    </div>
                    <div class="md:col-span-2">
                        <label class="block text-xs font-medium text-gray-400 mb-1">Site Description</label>
                        <textarea name="site_description" rows="2" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-primary" placeholder="Premium Digital Assets Marketplace"></textarea>
                    </div>
                </div>
            </div>

            <!-- Contact Settings -->
            <div class="glass-panel rounded-2xl p-6">
                <h2 class="text-xl font-bold text-white mb-4 flex items-center gap-2">
                    <i class="fa-solid fa-phone text-primary"></i> Contact Information
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-xs font-medium text-gray-400 mb-1">Mobile Number</label>
                        <input type="text" name="mobile_number" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-primary" placeholder="+1 234 567 8900">
                    </div>
                    <div>
                        <label class="block text-xs font-medium text-gray-400 mb-1">WhatsApp Number</label>
                        <input type="text" name="whatsapp_number" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-primary" placeholder="+1 234 567 8900">
                    </div>
                </div>
            </div>

            <!-- Payment Settings -->
            <div class="glass-panel rounded-2xl p-6">
                <h2 class="text-xl font-bold text-white mb-4 flex items-center gap-2">
                    <i class="fa-brands fa-paypal text-primary"></i> Payment Integration
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-xs font-medium text-gray-400 mb-1">PayPal ID / Email</label>
                        <input type="text" name="paypal_id" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-primary" placeholder="your@paypal.com">
                    </div>
                    <div>
                        <label class="block text-xs font-medium text-gray-400 mb-1">Currency Symbol</label>
                        <input type="text" name="currency_symbol" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-primary" placeholder="$">
                    </div>
                </div>
            </div>

            <!-- Social Media -->
            <div class="glass-panel rounded-2xl p-6">
                <h2 class="text-xl font-bold text-white mb-4 flex items-center gap-2">
                    <i class="fa-solid fa-share-nodes text-primary"></i> Social Media Links
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-xs font-medium text-gray-400 mb-1"><i class="fa-brands fa-facebook mr-2"></i>Facebook URL</label>
                        <input type="url" name="facebook_url" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-primary" placeholder="https://facebook.com/yourpage">
                    </div>
                    <div>
                        <label class="block text-xs font-medium text-gray-400 mb-1"><i class="fa-brands fa-twitter mr-2"></i>Twitter URL</label>
                        <input type="url" name="twitter_url" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-primary" placeholder="https://twitter.com/yourhandle">
                    </div>
                    <div>
                        <label class="block text-xs font-medium text-gray-400 mb-1"><i class="fa-brands fa-instagram mr-2"></i>Instagram URL</label>
                        <input type="url" name="instagram_url" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-primary" placeholder="https://instagram.com/yourprofile">
                    </div>
                    <div>
                        <label class="block text-xs font-medium text-gray-400 mb-1"><i class="fa-brands fa-linkedin mr-2"></i>LinkedIn URL</label>
                        <input type="url" name="linkedin_url" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-primary" placeholder="https://linkedin.com/company/yourcompany">
                    </div>
                    <div>
                        <label class="block text-xs font-medium text-gray-400 mb-1"><i class="fa-brands fa-youtube mr-2"></i>YouTube URL</label>
                        <input type="url" name="youtube_url" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-primary" placeholder="https://youtube.com/@yourchannel">
                    </div>
                </div>
            </div>

            <!-- SEO Settings -->
            <div class="glass-panel rounded-2xl p-6">
                <h2 class="text-xl font-bold text-white mb-4 flex items-center gap-2">
                    <i class="fa-solid fa-search text-primary"></i> SEO & Meta Tags
                </h2>
                <div class="space-y-4">
                    <div>
                        <label class="block text-xs font-medium text-gray-400 mb-1">Meta Title</label>
                        <input type="text" name="meta_title" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-primary" placeholder="DigiMarket - Premium Digital Assets">
                    </div>
                    <div>
                        <label class="block text-xs font-medium text-gray-400 mb-1">Meta Description</label>
                        <textarea name="meta_description" rows="2" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-primary" placeholder="Discover premium digital subscriptions and assets"></textarea>
                    </div>
                    <div>
                        <label class="block text-xs font-medium text-gray-400 mb-1">Meta Keywords</label>
                        <input type="text" name="meta_keywords" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-primary" placeholder="digital assets, marketplace, subscriptions">
                    </div>
                    <div>
                        <label class="block text-xs font-medium text-gray-400 mb-1">OG Image URL (Social Share)</label>
                        <input type="url" name="og_image_url" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-primary" placeholder="https://yoursite.com/og-image.jpg">
                    </div>
                </div>
            </div>

            <!-- Branding -->
            <div class="glass-panel rounded-2xl p-6">
                <h2 class="text-xl font-bold text-white mb-4 flex items-center gap-2">
                    <i class="fa-solid fa-palette text-primary"></i> Branding
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-xs font-medium text-gray-400 mb-1">Logo URL</label>
                        <input type="url" name="logo_url" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-primary" placeholder="https://yoursite.com/logo.png">
                    </div>
                    <div>
                        <label class="block text-xs font-medium text-gray-400 mb-1">Favicon URL</label>
                        <input type="url" name="favicon_url" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-primary" placeholder="https://yoursite.com/favicon.ico">
                    </div>
                </div>
            </div>

            <!-- Analytics -->
            <div class="glass-panel rounded-2xl p-6">
                <h2 class="text-xl font-bold text-white mb-4 flex items-center gap-2">
                    <i class="fa-solid fa-chart-line text-primary"></i> Analytics & Tracking
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-xs font-medium text-gray-400 mb-1">Google Analytics ID</label>
                        <input type="text" name="google_analytics_id" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-primary" placeholder="G-XXXXXXXXXX">
                    </div>
                    <div>
                        <label class="block text-xs font-medium text-gray-400 mb-1">Facebook Pixel ID</label>
                        <input type="text" name="facebook_pixel_id" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-primary" placeholder="123456789012345">
                    </div>
                </div>
            </div>

            <!-- Legal Pages -->
            <div class="glass-panel rounded-2xl p-6">
                <h2 class="text-xl font-bold text-white mb-4 flex items-center gap-2">
                    <i class="fa-solid fa-file-contract text-primary"></i> Legal Pages
                </h2>
                <div class="space-y-4">
                    <div>
                        <label class="block text-xs font-medium text-gray-400 mb-1">Terms & Conditions URL</label>
                        <input type="url" name="terms_url" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-primary" placeholder="https://yoursite.com/terms">
                    </div>
                    <div>
                        <label class="block text-xs font-medium text-gray-400 mb-1">Privacy Policy URL</label>
                        <input type="url" name="privacy_url" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-primary" placeholder="https://yoursite.com/privacy">
                    </div>
                    <div>
                        <label class="block text-xs font-medium text-gray-400 mb-1">Refund Policy URL</label>
                        <input type="url" name="refund_policy_url" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-primary" placeholder="https://yoursite.com/refunds">
                    </div>
                </div>
            </div>

            <!-- System Settings -->
            <div class="glass-panel rounded-2xl p-6">
                <h2 class="text-xl font-bold text-white mb-4 flex items-center gap-2">
                    <i class="fa-solid fa-server text-primary"></i> System Settings
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-xs font-medium text-gray-400 mb-1">Timezone</label>
                        <input type="text" name="timezone" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-primary" placeholder="UTC">
                    </div>
                    <div class="flex items-center gap-3 pt-6">
                        <input type="checkbox" name="maintenance_mode" id="maintenance_mode" class="w-4 h-4 rounded border-gray-700 bg-gray-800 text-red-500 focus:ring-red-500">
                        <label for="maintenance_mode" class="text-sm text-gray-300 cursor-pointer select-none">Enable Maintenance Mode</label>
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="flex justify-end gap-3">
                <button type="button" id="reset-btn" class="px-6 py-3 rounded-xl text-gray-400 hover:text-white font-medium transition-colors border border-gray-700 hover:border-gray-600">
                    <i class="fa-solid fa-rotate-left mr-2"></i>Reset to Defaults
                </button>
                <button type="submit" id="save-btn" class="bg-gradient-to-r from-primary to-secondary text-white px-8 py-3 rounded-xl font-semibold shadow-lg hover:opacity-90 transition-opacity">
                    <i class="fa-solid fa-save mr-2"></i>Save Settings
                </button>
            </div>
        </form>
    </main>

    <script>
        function showToast(message, type = 'success') {
            const container = document.getElementById('toast-container');
            const colors = {
                success: 'bg-green-500/10 border-green-500/20 text-green-400',
                error: 'bg-red-500/10 border-red-500/20 text-red-400',
                info: 'bg-blue-500/10 border-blue-500/20 text-blue-400'
            };
            const icons = {
                success: 'fa-check-circle',
                error: 'fa-triangle-exclamation',
                info: 'fa-info-circle'
            };
            const toast = document.createElement('div');
            toast.className = `${colors[type]} border p-4 rounded-xl backdrop-blur-md shadow-xl flex items-center gap-3 animate-bounce-in`;
            toast.innerHTML = `<i class="fa-solid ${icons[type]}"></i><span class="font-medium text-sm">${message}</span>`;
            container.appendChild(toast);
            setTimeout(() => toast.remove(), 3000);
        }

        async function loadSettings() {
            try {
                const res = await fetch('settings.php?action=get');
                const data = await res.json();
                if (data.error) {
                    showToast(data.error, 'error');
                    return;
                }
                const form = document.getElementById('settings-form');
                Object.keys(data).forEach(key => {
                    const input = form.elements[key];
                    if (input) {
                        if (input.type === 'checkbox') {
                            input.checked = Boolean(data[key]);
                        } else {
                            input.value = data[key] || '';
                        }
                    }
                });
            } catch (err) {
                showToast('Failed to load settings', 'error');
            }
        }

        document.getElementById('settings-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const formData = new FormData(e.target);
            const data = {};
            formData.forEach((value, key) => {
                data[key] = value;
            });
            data.maintenance_mode = document.getElementById('maintenance_mode').checked;

            try {
                const res = await fetch('settings.php?action=update', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
                const result = await res.json();
                if (result.success) {
                    showToast('Settings saved successfully', 'success');
                } else {
                    showToast(result.error || 'Failed to save settings', 'error');
                }
            } catch (err) {
                showToast('Failed to save settings', 'error');
            }
        });

        document.getElementById('reset-btn').addEventListener('click', async () => {
            if (!confirm('Are you sure you want to reset all settings to defaults?')) return;
            try {
                const res = await fetch('settings.php?action=reset', { method: 'POST' });
                const result = await res.json();
                if (result.success) {
                    showToast('Settings reset to defaults', 'success');
                    loadSettings();
                } else {
                    showToast(result.error || 'Failed to reset settings', 'error');
                }
            } catch (err) {
                showToast('Failed to reset settings', 'error');
            }
        });

        loadSettings();
    </script>
</body>
</html>
